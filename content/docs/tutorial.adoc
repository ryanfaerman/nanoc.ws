---
title: "Tutorial"
---

== Requirements

This tutorial does not cover the installation of nanoc. For information on how to install nanoc, as well as Ruby and Rubygems, check out the link:/install/[Install] page.

nanoc also requires some experience with Ruby. It is possible to use nanoc with no Ruby knowledge, but to take full advantage of nanoc, you’ll need to know Ruby well. I recommend the link:http://ruby-doc.org/docs/ProgrammingRuby/[Programming Ruby] book to people who don’t have a lot of Ruby experience yet.

== Creating a Site

nanoc is a command-line application. This means that in order to use nanoc, you have to type geeky commands into a terminal all day. Hey, that’s the way all cool apps work.

A nanoc-powered site is a directory with a specific structure. In this tutorial, we’ll create a site named `tutorial`. To create this site, type into the terminal:

[subs="quotes"]
--------------------------------------------------------------------------------
% *nanoc create-site tutorial*
--------------------------------------------------------------------------------

If you did that right, you should see something like this in the terminal:

[subs="quotes"]
--------------------------------------------------------------------------------
% *nanoc create-site tutorial*
      create  nanoc.yaml
      create  Rakefile
      create  Rules
      create  content/index.html
      create  content/stylesheet.css
      create  layouts/default.html
Created a blank nanoc site at \'tutorial'. Enjoy!
%
--------------------------------------------------------------------------------

The nanoc-powered site named `tutorial` has now been created. Go into the directory and list the files there. You should see something like this:

[subs="quotes"]
--------------------------------------------------------------------------------
% *cd tutorial*
tutorial% ls -l
total 24
-rw-r--r--  1 ddfreyne  staff   22 Feb 17 14:44 Rakefile
-rw-r--r--  1 ddfreyne  staff  692 Feb 17 14:44 Rules
-rw-r--r--  1 ddfreyne  staff  100 Feb 17 14:44 nanoc.yaml
drwxr-xr-x  4 ddfreyne  staff  136 Feb 17 14:44 content
drwxr-xr-x  3 ddfreyne  staff  102 Feb 17 14:44 layouts
drwxr-xr-x  3 ddfreyne  staff  102 Feb 17 14:44 lib
drwxr-xr-x  2 ddfreyne  staff   68 Feb 17 14:44 output
tutorial%
--------------------------------------------------------------------------------

What all those files and directories are for will all become clear soon.

== Compiling the Site

Before doing anything else, make sure the current working directory is the site you just created. All nanoc commands, except for `create-site`, require the current working directory to be a nanoc site. So, if you haven’t done it before:

[subs="quotes"]
--------------------------------------------------------------------------------
% *cd tutorial*
tutorial%
--------------------------------------------------------------------------------

Every new nanoc site already has a bit of content. It comes with one simple page with some simple "getting started" instructions. Before you can view the site, it needs to be compiled. To compile the site, do this:

[subs="quotes"]
--------------------------------------------------------------------------------
tutorial% *nanoc compile*
--------------------------------------------------------------------------------

Or, if you want it short, just type `nanoc`:

[subs="quotes"]
--------------------------------------------------------------------------------
tutorial% *nanoc*
--------------------------------------------------------------------------------

This is what’ll appear in the terminal while nanoc is compiling:

[subs="quotes"]
--------------------------------------------------------------------------------
tutorial% *nanoc compile*
Loading site data…
Compiling site…
      create  [0.01s] output/index.html

Site compiled in 0.01s.
tutorial%
--------------------------------------------------------------------------------

A file named `index.html` has been created in the `output` directory. The preferred way of previewing a site is using the `view` command, but we’ll need to install the `adsf` gem (_not_ `asdf`!) before we can preview:

[subs="quotes"]
--------------------------------------------------------------------------------
tutorial% *gem install adsf*
--------------------------------------------------------------------------------

NOTE: You may have to prefix the aforementioned command with `sudo`.

Now we can start a web server, like this:

[subs="quotes"]
--------------------------------------------------------------------------------
tutorial% *nanoc view*
--------------------------------------------------------------------------------

Now, open your web browser and navigate to link:http://localhost:3000/[http://localhost:3000/]. What you’ll see is something like this:

.Screenshot of what a brand new nanoc site looks like
image::/assets/images/tutorial/default-site.png[Screenshot of what a brand new nanoc site looks like,role="thumb"]

(If you open the `index.html` directly in your web browser, the stylesheet will most likely not be loaded. This is because the page has an _absolute_ link to the `style.css` file, not a relative one.)

You can also open the `output/index.html` file in your favourite text editor, where you’ll find that the file is just a normal HTML page.

== Editing the Home Page

The first step in getting to know how nanoc really works will involve editing the content of the home page. First, though, a quick explanation of how uncompiled pages are stored.

The pages in a nanoc site are stored in the `content` directory. Currently, that directory has only two files: `index.html` and `stylesheet.css`. The first file forms the home page, while the second file is the stylesheet. If you open the `index.html` file, you’ll notice a section containing metadata in YAML format at the top.

Let’s change the content of the home page. Open `index.html` and add a paragraph somewhere in the file. I recommend something like this:

[source,html]
--------------------------------------------------------------------------------
<p>This is a brand new paragraph which I've just inserted into this file! Gosh, I can barely control my excitement!</p>
--------------------------------------------------------------------------------

To view the changes, the site must be recompiled first. So, run the `compile` command. You should see something like this:

[subs="quotes"]
--------------------------------------------------------------------------------
tutorial% *nanoc compile*
Loading site data…
Compiling site…
      update  [0.01s] output/index.html

Site compiled in 0.01s.
tutorial%
--------------------------------------------------------------------------------

The number between brackets next to the `output/index.html` filename indicates the time it took for nanoc to compile the home page. At the bottom, the total time needed for compiling the entire site is also shown.

Make sure that the preview server (`nanoc view`) is still running, reload link:http://localhost:3000/[http://localhost:3000/] in your browser, and verify that the page has indeed been updated.

In the same file, let’s change the page title from "Home" to something more interesting. Change the line that reads `title: "Home"` to something else. The file should now start with this:

[source]
--------------------------------------------------------------------------------
title: "My New Home Page"
--------------------------------------------------------------------------------

The metadata section at the top of the file is formatted as YAML. All attributes are free-form; you can put anything you want in the attributes: the page title, keywords relevant to this page, the name of the page’s author, the language the page is written in, etc.

Recompile the site and once again load link:http://localhost:3000/[http://localhost:3000/] in your browser. You will see that the browser’s title bar displays the page’s title now. How the page title ends up between `<title>` and `</title>` will be explained in the <<customizing_the_layout>> section below!

== Adding a Page

In nanoc, pages are sometimes referred to as "items." This is because items don’t necessarily have to be pages: JavaScript and CSS files aren’t pages, but they are items.

To create a new page or item in the site, use the `create-item` command (or `ci` for short). Let’s create an "about" page like this:

[subs="quotes"]
--------------------------------------------------------------------------------
tutorial% *nanoc create-item about*
--------------------------------------------------------------------------------

You should see this:

[subs="quotes"]
--------------------------------------------------------------------------------
tutorial% *nanoc create-item about*
      create  content/about.html
tutorial%
--------------------------------------------------------------------------------

Open the newly generated file and put some text in it, like this (be sure to leave the metadata section intact):

[source,html]
--------------------------------------------------------------------------------
<h1>My cute little "About" page</h1>

<p>This is the about page for my new nanoc site.</p>
--------------------------------------------------------------------------------

In the metadata section, change the title to something else:

[source]
--------------------------------------------------------------------------------
title: "My Cool About Page"
--------------------------------------------------------------------------------

Recompile the site, and notice that a file `output/about/index.html` has been created. With the preview server running, open link:http://localhost:3000/about/[http://localhost:3000/about/] in your browser and admire your brand new about page. Shiny!

By the way, if you don’t like having a metadata section at the top of every page (perhaps because it breaks syntax highlighting), you can put the metadata in a YAML file with the same name as the page itself. For example, the `content/about.html` page could have its metadata stored in `content/about.yaml` instead.

== Customizing the Layout

The default home page recommended editing the default layout, so let’s see what we can do there.

As you probably have noticed already, the page’s content files are not complete HTML files—they are *partial* HTML files. A page needs `<html>`, `<head>`, `<body>`, … elements before it’s valid HTML. This doesn’t mean you’ve been writing invalid HTML all along, though, because nanoc *layouts* each page as a part of the compilation process.

Take a look at the `default.html` file in the `layouts` directory. Just like items, it contains a metadata section at the top of the file. Open it in your text editor. It *almost* looks like a HTML page:

[source,html]
--------------------------------------------------------------------------------
<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>A Brand New nanoc Site - <%= @item[:title] %></title> <!--1-->
    <link rel="stylesheet" href="/style.css">

    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="nanoc <%= Nanoc::VERSION %>"> <!--2-->
  </head>
  <body>
    <div id="main">
      <%= yield %> <!--3-->
    </div>
    <div id="sidebar">
      <h2>Documentation</h2>
      <ul>
        <li><a href="http://nanoc.ws/docs/">Documentation</a></li>
        <li><a href="http://nanoc.ws/docs/tutorial/">Getting Started</a></li>
      </ul>
      <h2>Community</h2>
      <ul>
        <li><a href="http://groups.google.com/group/nanoc/">Discussion Group</a></li>
        <li><a href="irc://chat.freenode.net/#nanoc">IRC Channel</a></li>
        <li><a href="http://github.com/nanoc/nanoc/wiki/">Wiki</a></li>
      </ul>
    </div>
  </body>
</html>
--------------------------------------------------------------------------------

There are three _eRuby_ instructions in this layout:

<1> Includes page title, as defined in the metadata
<2> Includes the current version of nanoc
<3> Includes the page content

Here’s a cheat sheet in case you’re not familar with eRuby:

`<% code %>`::
Runs the code between `<%` and `%>`

`<%= code %>`::
Runs the code between `<%=` and `%>`, and displays the return value on the web page

By the way, if you don’t like eRuby and would rather use something like Haml or Mustache, you can! Check out the link:/docs/reference/filters/#haml[Haml] and link:/docs/reference/filters/#mustache[Mustache] filters (filters will be explained below).

The `<%= yield %>` instruction will be replaced with the item’s compiled content when compiling. There is another important piece of eRuby code near the top of the file:

[source,html]
--------------------------------------------------------------------------------
<title>A Brand New nanoc Site - <%= @item[:title] %></title>
--------------------------------------------------------------------------------

This is where the page’s title is put into the compiled document.

Every page can have arbitrary metadata associated with it. To demonstrate this, add the following line to the metadata section of the about page:

[source]
--------------------------------------------------------------------------------
author: "John Doe"
--------------------------------------------------------------------------------

Now output the author name in the layout. Put this piece of code somewhere in your layout (somewhere between the `<body>` and `</body>` tags, please, or you won’t see a thing):

[source,html]
--------------------------------------------------------------------------------
<% if @item[:author] %>
  <p>This page was written by <%= @item[:author] %>.</p>
<% end %>
--------------------------------------------------------------------------------

Recompile the site, and load link:http://localhost:3000/about/[http://localhost:3000/about/] in your browser. You’ll see that the about page has a line saying `<p>This page was written by John Doe</p>`, while the home page does not—as expected!

== Writing Pages in Markdown

You don’t have to write pages in HTML. Sometimes, it is easier to use another language which can be converted to HTML instead. In this example, we’ll use link:http://daringfireball.net/projects/markdown[Markdown] to avoid having to write HTML. nanoc calls these text transformations *filters*.

Get rid of the content of the home page (`content/index.html`) and replace it with the following Markdown-formatted text (but leave the metadata section intact):

--------------------------------------------------------------------------------
# A First Level Header

## A Second Level Header

Now is the time for all good men to come to
the aid of their country. This is just a
regular paragraph.

The quick brown fox jumped over the lazy
dog’s back.

### Header 3

> This is a blockquote.
>
> This is the second paragraph in the blockquote.
>
> ## This is an H2 in a blockquote
--------------------------------------------------------------------------------

We’ll use link:http://kramdown.rubyforge.org/[kramdown] for converting Markdown into HTML. Before we can use kramdown, we need to install the gem, like this:

[subs="quotes"]
--------------------------------------------------------------------------------
% *gem install kramdown*
--------------------------------------------------------------------------------

NOTE: You may have to prefix the aforementioned command with `sudo`.

To tell nanoc to format the home page as Markdown, let nanoc run it through the `kramdown` filter. For this, the `Rules` file is used. This file specifies the processing instructions for all items.

The `Rules` file contains a bit of Ruby code like this:

[source,ruby]
--------------------------------------------------------------------------------
compile '*' do
  if item.binary?
    # don’t filter binary items
  else
    filter :erb
    layout 'default'
  end
end
--------------------------------------------------------------------------------

This is a _compilation_ rule, which means it will define how an item is processed. The string argument defines what items will be processed using this rule. The `*` wildcard matches zero or more characters, so in this case, all items will be processed using this rule. Inside the block, there is a check whether the item is binary (e.g. an image) or not (e.g. a HTML page or a CSS stylesheet). If the item is binary, nothing happens--the item is left unchanged. If the item is not binary, the `:erb` filter is run, after which the `default` layout is applied.

The `Rules` file also contains a call to `route`, and it looks similar to the call to `compile`:

[source,ruby]
--------------------------------------------------------------------------------
route '*' do
  if item.binary?
    # Write item with identifier /foo/ to /foo.ext
    item.identifier.chop + '.' + item[:extension]
  else
    # Write item with identifier /foo/ to /foo/index.html
    item.identifier + 'index.html'
  end
end
--------------------------------------------------------------------------------

This is a _routing_ rule, and therefore it defines where an item is written to once it is processed. Again, the string argument defines which items will be processed using this rule, and the `*` wildcard means it will apply to all items.

Inside the block, we check whether the item is binary or not. None of the items in the site are, so the items will be written to identifier + 'index.html', so an item with identifier `'/foo/'` is written to `'/foo/index.html'`.

To make sure that the home page (but not any other page) is run through the `kramdown` filter, we add a compilation rule *before* the existing compilation rule. It should look like this:

[source,ruby]
--------------------------------------------------------------------------------
compile '/' do
  filter :kramdown
  layout 'default'
end
--------------------------------------------------------------------------------

It is important that this rule comes *before* the existing one (`compile '*' do … end`). When compiling a page, nanoc will use the first and only the first matching rule; if the new compilation rule were *below* the existing one, it would never have been used.

The default routing rule still matches out needs, so we’ll keep that one intact.

Now that we’ve told nanoc to filter this page using kramdown, let’s recompile the site. The `output/index.html` page source should now contain this text (header and footer omited):

[source,html]
--------------------------------------------------------------------------------
<h1>A First Level Header</h1>

<h2>A Second Level Header</h2>

<p>Now is the time for all good men to come to
the aid of their country. This is just a
regular paragraph.</p>

<p>The quick brown fox jumped over the lazy
dog's back.</p>

<h3>Header 3</h3>

<blockquote>
    <p>This is a blockquote.</p>

    <p>This is the second paragraph in the blockquote.</p>

    <h2>This is an H2 in a blockquote</h2>
</blockquote>
--------------------------------------------------------------------------------

The kramdown filter is not the only filter you can use—take a look a the link:/docs/reference/filters/[full list of filters included with nanoc]. You can also write your own filters—read the link:/docs/extending-nanoc/#writing-filters[Writing Filters] section in the manual for details.

== Writing some Custom Code

There is a directory named `lib` in your nanoc site. In there, you can throw Ruby source files, and they’ll be read and executed before the site is compiled. This is therefore the ideal place to define helper methods.

As an example, let’s add some tags to a few pages, and then let them be displayed in a clean way using a few lines of custom code. Start off by giving the "about" page some tags. Open `about.html` and add this to the meta section:

[source]
--------------------------------------------------------------------------------
tags:
  - foo
  - bar
  - baz
--------------------------------------------------------------------------------

Next, create a file named `tags.rb` in the `lib` directory (the filename doesn’t really matter). In there, put the following function:

[source,ruby]
--------------------------------------------------------------------------------
def tags
  if @item[:tags].nil?
    '(none)'
  else
    @item[:tags].join(', ')
  end
end
--------------------------------------------------------------------------------

This function will take the current page’s tags and return a comma-separated list of tags. If there are no tags, it returns "(none)". To put this piece of code to use, open the default layout and add this line right above the `<%= yield %>` line:

[source,html]
--------------------------------------------------------------------------------
<p>Tags: <%= tags %></p>
--------------------------------------------------------------------------------

Recompile the site, and take a look at both HTML files in the `output` directory. If all went well, you should see a list of tags right above the page content.

Writing your own functions for handling tags is not really necessary, though, as nanoc comes with a tagging helper by default. To enable this tagging helper, first delete `tags.rb` and create a `helper.rb` file (again, the filename doesn’t really matter) and put this inside:

[source,ruby]
--------------------------------------------------------------------------------
include Nanoc::Helpers::Tagging
--------------------------------------------------------------------------------

This will make all functions defined in the `Nanoc::Helpers::Tagging` module available for use. You can check out the link:/docs/api/Nanoc/Helpers/Tagging.html[API documentation for the Tagging helper], but there is only one function we’ll use: `tags_for`. It’s very similar to the `tags` function we wrote before. Update the layout with this:

[source,html]
--------------------------------------------------------------------------------
<p>Tags: <%= tags_for(@item) %></p>
--------------------------------------------------------------------------------

Now compile the site again, and you’ll see that nanoc shows the tags for the page, but this time using the built-in tagging helper.

nanoc comes with quite a few useful helpers. The link:/docs/api/[API documentation] describes each one of them.

== That’s it!

This is the end of the tutorial. I hope that this tutorial both whet your appetite, and gave you enough information to get started with nanoc.

There’s more reading material. It’s definitely worth checking out the following chapters; they’re rather big, but they contains everything you need to know about nanoc.
